<div class="flex flex-col items-center w-full max-w-md mx-auto bg-white shadow-lg rounded-lg p-6">
  <div class="w-full">
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-2xl font-semibold">ตะกร้าสินค้า</h1>
      <%= button_to clear_carts_path, method: :delete, class: "px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg", form: { data: { turbo_confirm: "คุณแน่ใจหรือไม่ที่จะล้างตะกร้า?" } } do %>
          ล้างตะกร้า
        <% end %>
    </div>

    <% if @cart.items.any? %>
      <div class="space-y-4">
        <% @cart.items.each do |item| %>
          <% product = Product.find_by(id: item["product_id"]) %>
          <div class="flex justify-between items-center p-4 bg-gray-50 rounded-lg">
            <div class="flex-grow">
              <h3 class="font-medium"><%= item["name"] %></h3>
              <p class="text-gray-600">ราคา: <%= item["price"] %> บาท</p>
              <% if product.nil? %>
                <p class="text-red-600 mt-1">⚠️ สินค้านี้ไม่มีอยู่ในระบบแล้ว</p>
              <% elsif product.sold? %>
                <p class="text-red-600 mt-1">⚠️ สินค้านี้ถูกขายไปแล้ว</p>
              <% end %>
            </div>
            <%= button_to remove_item_carts_path, method: :delete, params: { product_id: item["product_id"] }, class: "px-2 py-1 bg-red-100 hover:bg-red-200 text-red-600 rounded-lg text-sm", form: { data: { turbo_confirm: "คุณแน่ใจหรือไม่ที่จะลบสินค้านี้ออกจากตะกร้า?" } } do %>
              ลบ
            <% end %>
          </div>
        <% end %>
      </div>

      <div class="mt-6 p-4 bg-gray-50 rounded-lg">
        <div class="flex justify-between items-center">
          <span class="font-medium">ราคารวม:</span>
          <span class="text-xl font-bold"><%= @cart.total_price %> บาท</span>
        </div>
      </div>

      <div class="mt-6 flex justify-between">
        <%= link_to root_path, class: "px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg" do %>
          เลือกสินค้าต่อ
        <% end %>

        <%= link_to purchase_all_carts_path,
              class: "px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg" do %>
            ซื้อทั้งหมด
          <% end %>
      </div>
    <% else %>
      <div class="text-center py-8">
        <p class="text-gray-600">ตะกร้าว่างเปล่า</p>
        <%= link_to root_path, class: "mt-4 inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg" do %>
          เลือกสินค้า
        <% end %>
      </div>
    <% end %>
  </div>
</div>
